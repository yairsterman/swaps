<div class="request-page">
    <div class="top-corner icon icon-delete" ng-click="close()"></div>
    <div class="match" ng-if="isMatch">
        <div class="title">
            I like you too!
            <div class="underline"></div>
        </div>

        <div class="photo">
            <div class="profile-img" style="background-image: url('{{profile.image}}')"></div>
        </div>

        <div class="sub-title center">
            You and {{profile.firstName}} have liked each others homes! <br>
            Why waste time? request to Swap now.
        </div>
        <input type="button" class="btn btn-primary btn-swap" value="Request Swap" ng-click="showRequest()">

    </div>
    <div class="request-swap {{receipt?'hide-request':''}}" ng-hide="requestComplete || isMatch">
        <div class="title">
            {{confirmation?'Confirm Swap':'Propose a Swap!'}}
            <div class="underline"></div>
        </div>
        <div class="sub-title center">
            Choose the dates you would like to propose to swap and the number of travelers you'll be.
        </div>
        <div class="single-swap add-swap">
            <div class="row search-area">
                <div class="search-field when transition-ease col-sm-9 col-xs-12">
                    <div class="row xs-flex">
                        <div class="{{swap.when?'col-xs-7 col-sm-7':'col-sm-12'}}">
                            <input type="text" class="form-control no-border {{datesError?'error':''}}" ng-focus="datesError=false" placeholder="Select Dates" id="searchDateAdd" name="searchDateAdd" ng-model="swap.dates" swap-dates="swap" user="user" profile="profile"
                                   user-city="userCity" locale-format="localeFormat" model-format="modelFormat"  find-travel="true" set-up-swap="true" datepicker
                                   data="data"  ng-change="changeDates(swap)">
                            <div class="glyphicon glyphicon glyphicon-remove {{swap.when?'':'pd-15'}}" ng-click="removeDates(swap)" ng-if="swap.dates"></div>
                            <span class="flexible-departure">{{swap.rangeLabel === 'Weekends'?'Next 4 weekends':''}}</span>
                        </div>
                        <div class="{{swap.when?'col-xs-5 col-sm-5':'col-xs-0'}} no-padding">
                            <div class="dropdown">
                                <div class="flexible-dates" data-toggle="dropdown" ng-if="swap.when">
                                    {{swap.rangeLabel === 'Weekends'? data.weekendStart[swap.startRange].value +'-'+data.weekendEnd[swap.endRange].value :swap.rangeLabel === 'Date Range'?(swap.startRange != swap.endRange?swap.startRange +'-'+ swap.endRange:swap.startRange)+ (swap.startRange>1?' Nights':' Night'): ''}}
                                    <span class="glyphicon glyphicon-chevron-down"></span>
                                </div>
                                <div class="dropdown-menu">
                                    <form name="rangeForm" class="range-wr" novalidate>
                                        <div ng-if="swap.rangeLabel === 'Weekends'" class="full-width">
                                            <div class="flex">
                                                <label class="flexible-label">Departure: </label>
                                                <select ng-model="swap.startRange" class="form-control">
                                                    <option ng-repeat="x in data.weekendStart" value="{{x.id}}">{{x.value}}</option>
                                                </select>
                                            </div>
                                            <div class="flex">
                                                <label class="flexible-label">Return: </label>
                                                <select ng-model="swap.endRange" class="form-control">
                                                    <option ng-repeat="x in data.weekendEnd" value="{{x.id}}">{{x.value}}</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div ng-if="swap.rangeLabel === 'Date Range'" class="duration-wr">
                                            <div class="no-padding col-xs-12">
                                                <div class="checkbox-wrapper">
                                                    <div class="single-checkbox">
                                                        <div class="things-checkbox" ng-click="setExactDates(swap)">
                                                            <div class="check icon icon-check {{exactDates?'checked':''}}"></div>
                                                        </div>
                                                        <div class="text">
                                                            Exact Dates
                                                        </div>
                                                    </div>
                                                    <div class="single-checkbox">
                                                        <div class="things-checkbox" ng-click="setExactDates(swap)">
                                                            <div class="check icon icon-check {{!exactDates?'checked':''}}"></div>
                                                        </div>
                                                        <div class="text">
                                                            <label class="flexible-label">Duration: </label>
                                                            <input type="text" class="form-control" placeholder="{{minNightsRange}}-{{maxNightsRange}}" name="durationRange" ng-model="swap.duration" ng-change="changeRange(swap)">
                                                            <span class="nights">Nights</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="icon icon-calender"></div>
                </div>
                <div class="search-field right transition-ease col-sm-3 col-xs-12 ">
                    <div class="guests-search">
                        <input type="number" class="form-control guests {{guestsError?'error':''}}" id="guests" placeholder="2" ng-model="swap.guests" ng-focus="guestsError=false" min="1" max="8">
                    </div>
                    <div class="icon icon-man-small"></div>
                </div>
            </div>
        </div>

        <div class="sub-title send-message">
            <label for="about" class="small-text blue">Tell {{profile.firstName}} a little about your trip</label>
            <textarea id="about" rows="3" cols="20" class="form-control send-text {{messageError?'error':''}}" ng-model="send.message" ng-focus="messageError=false" placeholder="Hey {{profile.firstName}}! ...">
                          </textarea>
        </div>
        <input type="button" class="btn btn-primary btn-swap" value="Propose Swap" ng-click="checkSwap()">
    </div>
    <div class="payment-receipt {{receipt?'show-receipt':''}} {{payment?'hide-receipt':''}}" ng-hide="requestComplete">
        <div class="deposit-plan">Security Deposit Plan - {{data.securityDeposit[profile.deposit].displayName}}</div>
        <div class="dates"></div>
        <div class="type">Payment</div>
        <!--<div class="amount">${{depositPlan.night}} Per Night X {{numberOfNights}} {{numberOfWeeks>1?'Nights':'Night'}} X {{swap.guests}} {{swap.guests>1?'Guest':'Guests'}}</div>-->
        <div class="amount">0 Per Night X {{numberOfNights}} {{numberOfWeeks>1?'Nights':'Night'}} X {{swap.guests}} {{swap.guests>1?'Guest':'Guests'}}</div>
        <div class="total">Total Payment: <strong>$0</strong></div>
        <div class="type">Deposit</div>
        <div class="amount">${{depositPlan.week}} Per Week X {{numberOfWeeks}} {{numberOfWeeks>1?'Weeks':'Week'}}</div>
        <div class="total">Total Deposit: <strong>${{totalDeposit}}</strong></div>
        <div class="terms">
            By continuing to payment you agree to our <br><a class="link" href="https://swapshome.com/terms-and-conditions" target="_blank">Terms and Conditions</a>
            and <a class="link" href="https://swapshome.com/privacy-policy" target="_blank">Privacy Policy</a>
        </div>
        <div class="buttons">
            <div class="back btn-primary" ng-click="goBack()">
                Back
            </div>
            <div class="pay btn-primary" ng-click="goToPayment()">
                Swap
            </div>
        </div>
    </div>
    <div class="payment-area {{payment?'show-payment':''}}" ng-hide="requestComplete">
        <payment ng-if="payment" data="data" deposit="totalDeposit" pay="totalPayment" user-id="userId" recipient-id="recipientId" dates="dates" message="send.message" guests="swap.guests" plan="profile.deposit" request-type="confirmation?data.requestType.confirm:data.requestType.request" request-id="requestId"></payment>
        <div class="loader-wrapper" ng-if="processing">
            <div class="loader">

            </div>
        </div>
    </div>
    <div class="request-complete" ng-if="requestComplete">
        <div class="title"> {{completeText}}</div>
        <div class="btn-primary ok-btn" ng-click="close()">OK</div>
    </div>
</div>
